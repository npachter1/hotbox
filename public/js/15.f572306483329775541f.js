(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"0ggE":function(t,e,i){"use strict";i.r(e);var n=i("o0o1"),s=i.n(n);i("PtK+");function a(t,e,i,n,s,a,o){try{var c=t[a](o),r=c.value}catch(t){return void i(t)}c.done?e(r):Promise.resolve(r).then(n,s)}var o,c,r={props:{id:{type:Number,default:null},package:{type:Object,default:null},model:{type:String,default:"Package"},module:{type:String,default:"outgoing"},adjustment_reasons:{type:Array,default:null}},data:function(){return{item:null,isLoading:!1,isDownloading:!1,isMedical:!1,newItem:{package_id:this.id,package_uom:"Grams",package_date:new Date,patient_license_number:null,product_requires_remediation:0,item_sections:[],item_sections_count:1}}},watch:{package:function(){this.initializeSection(0)}},mounted:(o=s.a.mark((function t(){var e=this;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch(this.module+"/setSchemas",this.model.toLowerCase());case 2:this.isLoading=!0,this.initializeSection(0),this.id?axios.get("/api/v1/"+this.schema.meta.resource+"/"+this.id).then((function(t){e.item=t.data,e.isLoading=!1,axios.get("/api/v1/admin/auth/location/ismedical/"+e.item.location_id).then((function(t){e.isMedical=t.data}))})).catch((function(t){e.isLoading=!1,e.$announcer({status:400,data:{message:"We had a hiccup fetching the data - Please try again later."}}),e.$emit("refresh",{},"log")})):(this.isLoading=!1,this.$announcer({status:422,data:{message:"Whoops - couldnt find the associated record - Please try again later."}}),this.$emit("refresh",{},"log"));case 5:case"end":return t.stop()}}),t,this)})),c=function(){var t=this,e=arguments;return new Promise((function(i,n){var s=o.apply(t,e);function c(t){a(s,i,n,c,r,"next",t)}function r(t){a(s,i,n,c,r,"throw",t)}c(void 0)}))},function(){return c.apply(this,arguments)}),methods:{submit:function(t){var e=this;this.$validator.validateAll().then((function(t){t&&e.$swal.fire({title:"Are you sure?",text:"This will create packages from package "+e.item.label,type:"warning",showCancelButton:!0,confirmButtonText:"Yes"}).then((function(t){t.value&&(e.isProcessing=!0,axios.post("/api/v1/"+e.schema.meta.resource+"/createPackages",e.newItem).then((function(t){e.$announcer({status:200,data:{message:"Success"}}),t.schema&&e.$store.commit(e.module+"/setSchema",{data:t.schema,key:e.model.toLowerCase()+"Schema"}),e.$router.push({name:e.model.toLowerCase()})})).catch((function(t){e.isProcessing=!1,e.$announcer(t.response)})))}))}))},initializeSection:function(t){this.newItem.item_sections[t]={},Vue.set(this.newItem.item_sections[t],"package_count",1),Vue.set(this.newItem.item_sections[t],"package_weights",null),Vue.set(this.newItem.item_sections[t],"product_weight",null),Vue.set(this.newItem.item_sections[t],"product_count",null),Vue.set(this.newItem.item_sections[t],"item_id",null),Vue.set(this.newItem.item_sections[t],"labels",[]),this.newItem.item_sections_count=t+1},setCount:function(t,e){Vue.set(this.newItem.item_sections[e],"package_count",t.srcElement.value),this.$forceUpdate()},setWeight:function(t,e){Vue.set(this.newItem.item_sections[e],"package_weights",t.srcElement.value);var i=this.newItem.item_sections[e].product_count,n=this.newItem.item_sections[e].product_weight,s=this.newItem.item_sections[e].package_weights;i>0&&i*n!==t.srcElement.value?(n=t.srcElement.value/i,Vue.set(this.newItem.item_sections[e],"product_weight",n)):n&&!i&&(Vue.set(this.newItem.item_sections[e],"product_count",Math.floor(s/n)),Vue.set(this.newItem.item_sections[e],"package_weights",n*Math.floor(s/n))),this.$forceUpdate()},setProductCount:function(t,e){Vue.set(this.newItem.item_sections[e],"product_count",t.srcElement.value);var i=this.newItem.item_sections[e].product_count,n=this.newItem.item_sections[e].product_weight,s=this.newItem.item_sections[e].package_weights;i&&n?Vue.set(this.newItem.item_sections[e],"package_weights",i*n):i&&s&&Vue.set(this.newItem.item_sections[e],"product_weight",s/i),this.$forceUpdate()},setProductWeight:function(t,e){Vue.set(this.newItem.item_sections[e],"product_weight",t.srcElement.value);var i=this.newItem.item_sections[e].product_count,n=this.newItem.item_sections[e].product_weight,s=this.newItem.item_sections[e].package_weights;i&&n?Vue.set(this.newItem.item_sections[e],"package_weights",i*n):n&&s&&(Vue.set(this.newItem.item_sections[e],"product_count",Math.floor(s/n)),Vue.set(this.newItem.item_sections[e],"package_weights",n*Math.floor(s/n))),this.$forceUpdate()},remainingWeight:function(){var t=this.item.quantity,e=0;return this.newItem.item_sections.forEach((function(t){e+=t.package_weights*t.package_count})),t-e},getMaxWeight:function(t){var e=this.newItem.item_sections[t].product_count,i=this.newItem.item_sections[t].product_weight,n=this.newItem.item_sections[t].package_count,s=this.newItem.item_sections[t].package_weights;if(n>0){var a=(this.remainingWeight()+s*n)/this.newItem.item_sections[t].package_count;Vue.set(this.newItem.item_sections[t],"package_weights",a),e&&!i?Vue.set(this.newItem.item_sections[t],"product_weight",a/e):i&&!e?(Vue.set(this.newItem.item_sections[t],"product_count",Math.floor(a/i)),Vue.set(this.newItem.item_sections[t],"package_weights",Math.floor(a/i)*i)):i&&e&&i*e!==a&&(Vue.set(this.newItem.item_sections[t],"product_count",Math.floor(a/i)),Vue.set(this.newItem.item_sections[t],"package_weights",Math.floor(a/i)*i))}this.$forceUpdate()},getMaxPackageCount:function(t){var e=this.newItem.item_sections[t].package_count,i=this.newItem.item_sections[t].package_weights,n=this.remainingWeight()+i*e,s=Math.floor(n/i);Vue.set(this.newItem.item_sections[t],"package_count",s),this.$forceUpdate()},setTag:function(t,e,i){Vue.set(this.newItem.item_sections[e].labels,i,t.srcElement.value)},removeSection:function(t){this.newItem.item_sections.splice(t,1),this.newItem.item_sections_count-=1,this.$forceUpdate()}},computed:{schema:function(){return this.$store.state[this.module][this.model.toLowerCase()+"Schema"]}}},u=(i("Jmuz"),i("KHd+")),m=Object(u.a)(r,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.item&&t.schema?i("div",{staticClass:"col-12"},[i("form",{staticClass:"modal-form",attrs:{id:"createpackages"},on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[i("fieldset",[i("h3",{staticClass:"mb-4"},[t._v("Create Packages")]),t._v(" "),t.item?i("div",{staticClass:"form-row"},[i("div",{staticClass:"col-3"},[i("label",[t._v("Source Package")]),t._v(" "),i("div",{staticClass:"form-group"},[t._v("\n                    "+t._s(t.item.label)+"\n                ")])]),t._v(" "),i("div",{staticClass:"col-3"},[i("label",[t._v("Product")]),t._v(" "),i("div",{staticClass:"form-group"},[t._v("\n                    "+t._s(t.item.item.name)+"\n                ")])]),t._v(" "),i("div",{staticClass:"col-3"},[i("label",[t._v("Total Weight")]),t._v(" "),i("div",{staticClass:"form-group"},[t._v("\n                    "+t._s(t.item.quantity)+" "+t._s(t.item.unit_of_measure)+"\n                ")])]),t._v(" "),i("div",{staticClass:"col-3"},[i("label",[t._v("Remaining Weight")]),t._v(" "),i("div",{staticClass:"form-group",staticStyle:{color:"red"}},[t._v("\n                    "+t._s(t.remainingWeight())+" "+t._s(t.newItem.package_uom?t.newItem.package_uom:"")+"\n                ")])])]):t._e(),t._v(" "),i("div",{staticClass:"form-row"},[i("div",{staticClass:"col-6"},[i("label",[t._v("Date")]),t._v(" "),i("div",{staticClass:"form-group"},[i("datepicker",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{id:"item-date",name:"date",format:"MM/dd/yyyy","bootstrap-styling":!0,"input-class":"form-datepicker"},model:{value:t.newItem.package_date,callback:function(e){t.$set(t.newItem,"package_date",e)},expression:"newItem.package_date"}})],1)]),t._v(" "),i("div",{staticClass:"col-6"},[i("label",[t._v("Unit of Measure")]),t._v(" "),i("div",{staticClass:"form-group"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.newItem.package_uom,expression:"newItem.package_uom"}],staticClass:"form-control",attrs:{name:"package_uom"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.newItem,"package_uom",e.target.multiple?i:i[0])}}},[i("option",{attrs:{value:"Milligrams"}},[t._v("Milligrams")]),t._v(" "),i("option",{attrs:{value:"Grams"}},[t._v("Grams")]),t._v(" "),i("option",{attrs:{value:"Ounces"}},[t._v("Ounces")]),t._v(" "),i("option",{attrs:{value:"Kilograms"}},[t._v("Kilograms")]),t._v(" "),i("option",{attrs:{value:"Pounds"}},[t._v("Pounds")])])])]),t._v(" "),t.isMedical?i("div",{staticClass:"col-6"},[i("label",{attrs:{for:"item-patient_license_number"}},[t._v("Patient License Number")]),t._v(" "),i("div",{staticClass:"form-group"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.newItem.patient_license_number,expression:"newItem.patient_license_number"},{name:"validate",rawName:"v-validate"}],ref:"patient_license_numberInput",staticClass:"form-control",class:{input:!0,"text-danger":t.errors.has("patient_license_number")},attrs:{id:"item-patient_license_number","aria-describedby":"addon-right addon-left",name:"patient_license_number",type:"text",placeholder:""},domProps:{value:t.newItem.patient_license_number},on:{input:function(e){e.target.composing||t.$set(t.newItem,"patient_license_number",e.target.value)}}}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("patient_license_number"),expression:"errors.has('patient_license_number')"}],staticClass:"form-text text-muted text-danger"},[t._v(t._s(t.errors.first("patient_license_number")))])])]):t._e(),t._v(" "),i("div",{staticClass:"col-6"},[i("label",[t._v("Requires Remediation")]),t._v(" "),i("div",{staticClass:"form-group"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.newItem.product_requires_remediation,expression:"newItem.product_requires_remediation"}],staticClass:"form-control",attrs:{name:"is_production_batch"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.newItem,"product_requires_remediation",e.target.multiple?i:i[0])}}},[i("option",{attrs:{value:"1"}},[t._v("True")]),t._v(" "),i("option",{attrs:{value:"0"}},[t._v("False")])])])]),t._v(" "),t._m(0),t._v(" "),t._l(t.newItem.item_sections_count,(function(e){return[i("div",{staticClass:"col-4"},[i("label",{attrs:{for:"item-item_id"}},[t._v("Product")]),t._v(" "),t.newItem.item_sections[e-1]?i("div",{staticClass:"form-group"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.newItem.item_sections[e-1].item_id,expression:"newItem.item_sections[n-1].item_id"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"form-control",on:{change:function(i){var n=Array.prototype.filter.call(i.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.newItem.item_sections[e-1],"item_id",i.target.multiple?n:n[0])}}},t._l(t.schema.form.product_id.values,(function(e){return i("option",{domProps:{value:e.id}},[t._v(t._s(e.name))])})),0)]):t._e()]),t._v(" "),i("div",{staticClass:"col-2"},[i("label",[t._v("Weight / Product")]),t._v(" "),t.newItem.item_sections[e-1]?i("div",{staticClass:"form-group"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.newItem.item_sections[e-1].product_weight,expression:"newItem.item_sections[n-1].product_weight"}],staticClass:"form-control",attrs:{type:"text",name:"product_weight"},domProps:{value:t.newItem.item_sections[e-1].product_weight},on:{change:function(i){t.setProductWeight(i,e-1)},input:function(i){i.target.composing||t.$set(t.newItem.item_sections[e-1],"product_weight",i.target.value)}}})]):t._e()]),t._v(" "),i("div",{staticClass:"col-2"},[i("label",[t._v("Products / Package")]),t._v(" "),t.newItem.item_sections[e-1]?i("div",{staticClass:"form-group"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.newItem.item_sections[e-1].product_count,expression:"newItem.item_sections[n-1].product_count"}],staticClass:"form-control",attrs:{type:"text",name:"product_count"},domProps:{value:t.newItem.item_sections[e-1].product_count},on:{change:function(i){t.setProductCount(i,e-1)},input:function(i){i.target.composing||t.$set(t.newItem.item_sections[e-1],"product_count",i.target.value)}}})]):t._e()]),t._v(" "),i("div",{staticClass:"col-2"},[i("label",[t._v("Weight / Package")]),t._v(" "),t.newItem.item_sections[e-1]?i("div",{staticClass:"form-group",staticStyle:{"margin-bottom":"0"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.newItem.item_sections[e-1].package_weights,expression:"newItem.item_sections[n-1].package_weights"}],staticClass:"form-control",attrs:{type:"text",name:"package_weight"},domProps:{value:t.newItem.item_sections[e-1].package_weights},on:{change:function(i){t.setWeight(i,e-1)},input:function(i){i.target.composing||t.$set(t.newItem.item_sections[e-1],"package_weights",i.target.value)}}})]):t._e(),t._v(" "),i("a",{staticStyle:{color:"red","font-size":"smaller","margin-left":"5px",cursor:"pointer"},on:{click:function(i){return t.getMaxWeight(e-1)}}},[t._v("(Max)")])]),t._v(" "),i("div",{staticClass:"col-2"},[i("label",[t._v("Package Count")]),t._v(" "),t.newItem.item_sections[e-1]?i("div",{staticClass:"form-group",staticStyle:{"margin-bottom":"0"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.newItem.item_sections[e-1].package_count,expression:"newItem.item_sections[n-1].package_count"}],staticClass:"form-control",attrs:{type:"text",name:"package_count"},domProps:{value:t.newItem.item_sections[e-1].package_count},on:{change:function(i){t.setCount(i,e-1)},input:function(i){i.target.composing||t.$set(t.newItem.item_sections[e-1],"package_count",i.target.value)}}})]):t._e(),t._v(" "),i("a",{staticStyle:{color:"red","font-size":"smaller","margin-left":"5px",cursor:"pointer"},on:{click:function(i){return t.getMaxPackageCount(e-1)}}},[t._v("(Max)")])]),t._v(" "),t.newItem.item_sections[e-1]?i("div",{staticClass:"col-6"},[i("label",[t._v("Package Tag # (s)")]),t._v(" "),t._l(1*t.newItem.item_sections[e-1].package_count,(function(n){return i("div",{staticClass:"form-group"},[i("input",{staticClass:"form-control",attrs:{type:"text"},on:{change:function(i){return t.setTag(i,e-1,n-1)}}})])}))],2):t._e(),t._v(" "),i("div",{staticClass:"col-12",staticStyle:{"text-align":"right"}},[i("br"),t._v(" "),i("a",{staticStyle:{cursor:"pointer","margin-right":"5px"},on:{click:function(i){return t.removeSection(e-1)}}},[i("i",{staticClass:"hotbox-icon hotbox-icon-trash-round show-red"})]),t._v(" "),i("hr")])]})),t._v(" "),i("br"),t._v(" "),i("div",{staticClass:"col-12",staticStyle:{"text-align":"right"}},[i("a",{staticStyle:{cursor:"pointer","margin-right":"5px"},on:{click:function(e){return t.initializeSection(t.newItem.item_sections_count)}}},[i("i",{staticClass:"hotbox-icon hotbox-icon-c-add"})])]),t._v(" "),i("br"),i("br")],2),t._v(" "),t._m(1)])])]):i("div",[i("loading",{attrs:{display:!t.schema||!t.item,type:"loadModal"}})],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-12"},[e("hr")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-12 clearfix mt-2 text-center"},[e("button",{staticClass:"btn btn-info",attrs:{type:"submit"}},[this._v("Create Packages")])])}],!1,null,null,null);e.default=m.exports},"4az+":function(t,e,i){var n=i("xB3T");"string"==typeof n&&(n=[[t.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(n,s);n.locals&&(t.exports=n.locals)},Jmuz:function(t,e,i){"use strict";var n=i("4az+");i.n(n).a},"PtK+":function(t,e,i){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}i.d(e,"a",(function(){return r}));var r=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,o(e).apply(this,arguments))}var i,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,t),i=e,(n=[{key:"resource",value:function(){return"admin/grow/packages"}},{key:"primaryKey",value:function(){return"id"}}])&&s(i.prototype,n),r&&s(i,r),e}(i("YA5Z").a)},xB3T:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,"\n.vdp-datepicker__calendar {\n    left: 0px;\n}\n",""])}}]);