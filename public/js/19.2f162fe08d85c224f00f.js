(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{C73q:function(t,e,i){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}i.d(e,"a",(function(){return l}));var l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,s(e).apply(this,arguments))}var i,r,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(e,t),i=e,(r=[{key:"resource",value:function(){return"admin/grow/transfers"}},{key:"primaryKey",value:function(){return"id"}}])&&n(i.prototype,r),l&&n(i,l),e}(i("YA5Z").a)},YMI0:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,"\n[data-v-5af49567] .grid-table > tbody > tr > td:last-of-type {\n    width: 1%;\n    white-space: nowrap;\n}\n",""])},lzmu:function(t,e,i){"use strict";i.r(e);var r=i("o0o1"),n=i.n(r),a=i("C73q"),s=i("LvDl"),o=i.n(s);function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function c(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(t,e,i,r,n,a,s){try{var o=t[a](s),l=o.value}catch(t){return void i(t)}o.done?e(l):Promise.resolve(l).then(r,n)}var u,h,f={props:{module:{type:String,default:"outgoing"},model:{type:String,default:"transfer"},filters:{type:Object,default:function(){}}},data:function(){return{isLoading:!1,isDownloading:!1,shouldReload:!1,gridData:null,gridSearch:null,gridPage:1,gridColumns:null,gridFilters:null}},components:{},mounted:function(){this.gridSearch=this.$route.query.search||null,this.regulatoryAgent=this.$store.getters.getAgent,this.schema&&(this.setFilters(this.$route.params.focus),this.gridColumns=this.schema.meta.fields),this.restoreGridSettings()},methods:{fetchGrid:(u=n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.schema&&this.gridFilters){t.next=4;break}return t.abrupt("return",!1);case 4:if(1!=this.isLoading){t.next=6;break}return t.abrupt("return",!1);case 6:return this.$store.commit(this.module+"/setSearch",{gridPage:null,gridFilters:null,options:{merge:!0}}),this.$store.commit(this.module+"/setSearch",{gridPage:this.gridPage,gridFilters:this.gridFilters,options:{merge:!0}}),this.isLoading=!0,t.next=11,(new a.a).setFilters(this.gridFilters.filter).params({search:this.gridSearch}).orderBy((this.gridFilters.orderDesc?"-":"")+this.gridFilters.sortBy).limit(this.gridFilters.pageLimit).page(this.gridPage).get();case 11:this.gridData=t.sent,this.mergeGridData(),this.isLoading=!1;case 14:case"end":return t.stop()}}),t,this)})),h=function(){var t=this,e=arguments;return new Promise((function(i,r){var n=u.apply(t,e);function a(t){d(n,i,r,a,s,"next",t)}function s(t){d(n,i,r,a,s,"throw",t)}a(void 0)}))},function(){return h.apply(this,arguments)}),searchGrid:o.a.debounce((function(t){this.gridPage=1,this.fetchGrid()}),500),setFilters:function(){var t=this;arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.schema)return!1;this.gridFilters={pageLimit:20,sortBy:Object.keys(this.schema.filters).find((function(e){return"daterange"===t.schema.filters[e].type}))||"rank",orderDesc:!0,filter:Object.assign.apply(Object,[{}].concat(c(Object.keys(this.schema.filters).map((function(t){return l({},t,["all"])}))),[this.filters]))}},renderRowBg:function(t,e){return t&&"unpaid"==t.status?"table-warning":null},confirmDelete:function(t){var e=this;this.$swal.fire({title:"Are you sure?",text:"This will Cancel the transfer, and rollback any receiving requests and the package assignments.",type:"warning",showCancelButton:!0,confirmButtonText:"Yes, Cancel Transfer"}).then((function(i){i.value&&(e.isLoading=!0,new a.a({id:t}).delete().then((function(t){e.isLoading=!1,e.$store.dispatch(e.module+"/setSchemas",e.model.toLowerCase()),e.$announcer(t),e.fetchGrid()})).catch((function(t){e.isLoading=!1,e.$announcer(t.response)})))}))},updateStatus:function(t,e){var i=this;this.isLoading=!0,axios.put("/api/v1/"+this.schema.meta.resource+"/"+t+"/modify",{id:t,status:e}).then((function(t){i.isLoading=!1,i.$store.dispatch(i.module+"/setSchemas",i.model.toLowerCase()),i.$announcer(t),i.fetchGrid()})).catch((function(t){i.isLoading=!1,i.$announcer(t.response)}))},downloadExport:function(t){var e=this;this.isDownloading=!0,axios({url:(new a.a).setFilters(this.gridFilters.filter).custom(this.schema.meta.resource+"/export/"+t).getUrl(),method:"GET",responseType:"blob"}).then((function(t){e.isDownloading=!1,e.downloadFile(t)})).catch((function(t){e.isDownloading=!1,e.$announcer(t.response)}))},downloadInvoice:function(t){alert("feature coming soon..")},rowToggle:function(t){var e=this;t.item.changed?this.$swal.fire({title:"Changes Not Saved",text:"Do you want to save changes?",type:"warning",showCancelButton:!0,confirmButtonText:"Save Changes",cancelButtonText:"Discard Changes"}).then((function(i){i.value?e.$refs.editForm._save(!0):(t.item.changed=!1,t.toggleDetails())})):t.toggleDetails()},rowChange:function(t){t.item.changed=!0},rowReset:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e){var i=this.gridData.data.findIndex((function(t){return t.id==e.id}));e.archived_at?this.gridData.data.splice(i,1):this.gridData.data.splice(i,1,Object.assign(this.gridData.data[i],e))}t.item.changed=!1},scrollIntoView:function(t){if(this.scrollIntoViewId&&this.scrollIntoViewId===t){var e=document.getElementById(this.model.toLowerCase()+"_table__row_"+this.scrollIntoViewId);e&&(e.scrollIntoView({behavior:"smooth",block:"start"}),this.scrollIntoViewId=null)}},restoreGridSettings:function(){var t=this.$store.state[this.module].search;t&&(t.gridSearch&&(this.gridSearch=t.gridSearch),t.gridPage&&(this.gridPage=t.gridPage),t.gridFilters&&(this.gridFilters=t.gridFilters),t.gridColumns&&(this.gridColumns=t.gridColumns))},mergeGridData:function(){var t=this;this.$store.state[this.module].search&&this.$store.state[this.module].search.gridData&&Array.isArray(this.gridData.data)&&this.$store.state[this.module].search.gridData.forEach((function(e,i){var r=t.gridData.data.findIndex((function(t){return t.id===e.id}));r>-1&&t.$set(t.gridData.data[r],"_showDetails",!0),0===i&&(t.scrollIntoViewId=e.id)}))}},computed:{schema:function(){return this.$store.state[this.module][this.model.toLowerCase()+"Schema"]},columnsVisible:function(){return this.gridColumns?this.gridColumns.filter((function(t){return!0===t.toggle||!t.hasOwnProperty("toggle")})):[]}},watch:{gridData:{handler:function(t,e){var i=t.data.filter((function(t){return t._showDetails})).map((function(t){return{id:t.id,_showDetails:t._showDetails}}));this.$store.commit(this.module+"/setSearch",{gridData:i,options:{merge:!0}})},deep:!0},gridColumns:{handler:function(){this.$store.commit(this.module+"/setSearch",{gridColumns:this.gridColumns,options:{merge:!0}})},deep:!0},gridSearch:function(){this.$store.commit(this.module+"/setSearch",{gridSearch:this.gridSearch,options:{merge:!0}})},gridFilters:{handler:function(t,e){this.gridPage=1,this.gridFilters&&this.fetchGrid()},deep:!0},gridPage:function(t,e){this.gridFilters&&this.fetchGrid()},schema:{handler:function(t,e){!e&&t?this.setFilters():o.a.isEqual(t.filters,e.filters)?1==this.shouldReload&&(this.fetchGrid(),this.shouldReload=!1):this.setFilters(),t&&!this.gridColumns&&(this.gridColumns=t.meta.fields)},deep:!0}}},g=(i("wcWo"),i("KHd+")),m=Object(g.a)(f,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.schema?i("div",{staticClass:"col-12"},[i("form",[i("div",{staticClass:"table-filter-row"},[i("div",{staticClass:"filter-search",class:{active:t.gridSearch}},[i("div",{staticClass:"input-group"},[t._m(0),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.gridSearch,expression:"gridSearch"}],staticClass:"form-control border-left-0",attrs:{type:"text",placeholder:t.schema.lang.searchPrompt||"Search Grid"},domProps:{value:t.gridSearch},on:{input:[function(e){e.target.composing||(t.gridSearch=e.target.value)},t.searchGrid],keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.searchGrid(e))}}})])]),t._v(" "),t.gridFilters?i("div",{staticClass:"filters"},[t.gridData?i("filter-more",{attrs:{meta:t.gridData.meta,schema:t.schema,gridFilters:t.gridFilters,columns:t.gridColumns,isDownloading:t.isDownloading},on:{"update:gridFilters":function(e){t.gridFilters=e},"update:grid-filters":function(e){t.gridFilters=e},"update:columns":function(e){t.gridColumns=e},downloadExport:t.downloadExport}}):t._e(),t._v(" "),t._l(t.schema.filters,(function(e,r){return"wherein"==e.type?i("filter-in",{key:r,attrs:{schema:e,filter:t.gridFilters.filter[r]},on:{update:function(e){t.gridFilters.filter[r]=e}}}):t._e()})),t._v(" "),t._l(t.schema.filters,(function(e,r){return"daterange"==e.type?i("filter-date",{key:r,attrs:{schema:e,filter:t.gridFilters.filter[r]},on:{update:function(e){t.gridFilters.filter[r]=e}}}):t._e()}))],2):t._e()])]),t._v(" "),i("loading",{attrs:{display:t.isLoading,type:"loadGrid"}}),t._v(" "),i("transition",{attrs:{name:"bo-slide"}},[t.schema&&t.gridFilters?i("b-table",{staticClass:"grid-table",attrs:{striped:"",hover:"",id:t.model.toLowerCase()+"_table","primary-key":"id",items:t.gridData?t.gridData.data:[],fields:t.columnsVisible,busy:t.isLoading,"show-empty":!0,"sort-by":t.gridFilters.sortBy,"sort-desc":t.gridFilters.orderDesc,"no-local-sorting":!0,"no-local-filtering":!0,"per-page":0,tbodyTrClass:t.renderRowBg,"tbody-transition-props":{name:"hb-list-fade"},responsive:"md",stacked:"sm"},on:{"update:busy":function(e){t.isLoading=e},"update:sortBy":function(e){return t.$set(t.gridFilters,"sortBy",e)},"update:sort-by":function(e){return t.$set(t.gridFilters,"sortBy",e)},"update:sortDesc":function(e){return t.$set(t.gridFilters,"orderDesc",e)},"update:sort-desc":function(e){return t.$set(t.gridFilters,"orderDesc",e)}},scopedSlots:t._u([t._l(t.schema.meta.fields,(function(e,r){return{key:"head(field.key)",fn:function(r){return[i("em",[e.icon?i("i",{class:e.icon}):t._e(),t._v(" "),e.description?i("i",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:e.description,expression:"field.description",modifiers:{hover:!0}}],staticClass:"hotbox-icon hotbox-icon-c-question",attrs:{title:e.name}}):t._e(),t._v(" "),i("span",[t._v(t._s(r.label))])])]}}})),{key:"cell(created_at)",fn:function(e){return[t._v("\n                "+t._s(t._f("localDate")(e.value))+"\n            ")]}},{key:"cell(updated_at)",fn:function(e){return[t._v("\n                "+t._s(t._f("localDate")(e.value))+"\n            ")]}},{key:"cell(received_at)",fn:function(e){return[t._v("\n                "+t._s(t._f("localDate")(e.value))+"\n            ")]}},{key:"cell(manifest_number)",fn:function(e){return[t._v("\n                "+t._s(e.value)),i("br"),t._v(" "),i("span",{staticClass:"small"},[t._v(t._s(t._f("renderValue")(e.item.type,t.schema.form.type.values)))])]}},{key:"cell(receiver)",fn:function(e){return[e.item.receiver?i("span",[t._v("\n                    "+t._s(e.item.receiver.name)+" "+t._s(e.item.receiver.licensenum)),i("br"),t._v(" "),i("span",{staticClass:"small"},[t._v(t._s(e.item.receiver.city))])]):i("span",[t._v("--")])]}},{key:"cell(transporter_name)",fn:function(e){return[e.item.transporter_name?i("span",[t._v("\n                    "+t._s(e.value)),i("br"),t._v(" "),i("span",{staticClass:"small"},[t._v("Lic: "+t._s(e.item.transporter_licensenum))])]):i("span",[t._v("--")])]}},{key:"cell(packages_count)",fn:function(e){return[t._v("\n                "+t._s(e.item.packages.length||0)+"\n            ")]}},{key:"cell(status)",fn:function(e){return[i("i",{staticClass:"float-right mr-2 mt-1",class:{"ti-angle-double-down":!e.detailsShowing,"ti-angle-double-up":e.detailsShowing},on:{click:e.toggleDetails}}),t._v("\n                "+t._s(t._f("ucwords")(e.value||"confirmed"))+"\n            ")]}},{key:"cell(actions)",fn:function(e){return[i("div",{staticClass:"dropdown"},[i("a",{attrs:{"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[i("i",{staticClass:"ti-more-alt"})]),t._v(" "),i("div",{staticClass:"dropdown-menu tight dropdown-menu-right"},["external"==e.item.type?i("a",{staticClass:"dropdown-item action-primary",attrs:{href:""},on:{click:function(i){return i.preventDefault(),t.downloadInvoice(e.item.id)}}},[i("i",{staticClass:"hotbox-icon hotbox-icon-square-download"}),t._v(" Download Invoice")]):t._e(),t._v(" "),"unpaid"==e.item.status?i("a",{staticClass:"dropdown-item action-success",attrs:{href:""},on:{click:function(i){return i.preventDefault(),t.updateStatus(e.item.id,"confirmed")}}},[i("i",{staticClass:"hotbox-icon hotbox-icon-s-check"}),t._v(" Mark as Paid")]):t._e(),t._v(" "),i("a",{staticClass:"dropdown-item action-danger",attrs:{href:""},on:{click:function(i){return i.preventDefault(),t.confirmDelete(e.item.id)}}},[i("i",{staticClass:"hotbox-icon hotbox-icon-trash-round"}),t._v(" Delete and Unlink")])])])]}},{key:"row-details",fn:function(e){return[i("div",{staticClass:"card card-stats px-3 justify-content-center"},[i("div",{staticClass:"card-header"}),t._v(" "),i("div",{staticClass:"card-body"},[i("h5",{staticClass:"mt-2"},[t._v("Packages Manifest")]),t._v(" "),i("ul",t._l(e.item.packages,(function(e,r){return i("li",{staticClass:"d-flex justify-content-between align-items-center position-relative px-2 mb-3"},[i("div",{},[t._v("\n                                    "+t._s((e.item||{}).name||"Misc Item")),i("br"),t._v(" "),i("span",{staticClass:"small"},[i("i",{staticClass:"hotbox-icon hotbox-icon-tag-content"}),t._v(" "+t._s(e.label))])]),t._v(" "),i("div",{staticClass:"ml-auto text-right"},[t._v("\n                                    "+t._s(e.quantity)+"/"+t._s(e.unit_of_measure)),i("br"),t._v(" "),e.received_price>0?i("span",{staticClass:"small"},[t._v("$"+t._s(t._f("dollar")(e.received_price)))]):t._e()])])})),0),t._v(" "),e.item.transfersale_total>0?i("div",{staticClass:"col-12 text-right mt-1 mb-3",staticStyle:{"border-top":"1px solid #E6E6E6"}},[e.item.transfersale_fee>0?i("span",{},[t._v("Service Fee: $"+t._s(t._f("dollar")(e.item.transfersale_fee))),i("br")]):t._e(),t._v(" "),i("b",[t._v("Total Billed: $"+t._s(t._f("dollar")(e.item.transfersale_total)))])]):t._e()])])]}},t.gridData?{key:"table-caption",fn:function(){return[t.gridData.data.length>0?i("div",[t.gridData.meta?i("span",[t._v("\n                        Showing "+t._s(t.gridData.meta.per_page*(t.gridPage-1)+1)+" to "+t._s(t.gridData.meta.per_page*t.gridPage<t.gridData.meta.total?t.gridData.meta.per_page*t.gridPage:t.gridData.meta.total)+" of "+t._s(t.gridData.meta.total)+" "+t._s(t.schema.lang.items?t.schema.lang.items:"Records")+"\n                    ")]):i("span",[t._v("Showing All "+t._s(t.schema.lang.items?t.schema.lang.items:"Records"))]),t._v(" "),i("div",{staticClass:"table-pager-footer"},[t.gridData.meta.total>0?i("b-pagination",{attrs:{"total-rows":t.gridData.meta.total,"per-page":t.gridData.meta.per_page,"aria-controls":"users_table"},model:{value:t.gridPage,callback:function(e){t.gridPage=e},expression:"gridPage"}}):t._e()],1)]):t._e()]},proxy:!0}:null,{key:"empty",fn:function(){return[t.isLoading?i("div",{staticClass:"h-100"},[t._v("Â ")]):i("div",[i("img",{attrs:{src:"/images/logo.png",alt:"No Results",width:"75"}}),t._v(" "),i("h4",[t._v("Hmm, There are currently no Results.")])])]},proxy:!0}],null,!0)}):t._e()],1)],1):i("div",[i("loading",{attrs:{display:!t.schema,type:"loadPage"}})],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-prepend"},[e("i",{staticClass:"hotbox-icon hotbox-icon-search-2"})])}],!1,null,"5af49567",null);e.default=m.exports},mDqG:function(t,e,i){var r=i("YMI0");"string"==typeof r&&(r=[[t.i,r,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(r,n);r.locals&&(t.exports=r.locals)},wcWo:function(t,e,i){"use strict";var r=i("mDqG");i.n(r).a}}]);