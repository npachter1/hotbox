(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{C73q:function(t,e,r){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}r.d(e,"a",(function(){return l}));var l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,a(e).apply(this,arguments))}var r,i,l;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(e,t),r=e,(i=[{key:"resource",value:function(){return"admin/grow/transfers"}},{key:"primaryKey",value:function(){return"id"}}])&&n(r.prototype,i),l&&n(r,l),e}(r("YA5Z").a)},lzmu:function(t,e,r){"use strict";r.r(e);var i=r("o0o1"),n=r.n(i),s=r("C73q"),a=r("LvDl"),o=r.n(a);function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(t,e,r,i,n,s,a){try{var o=t[s](a),l=o.value}catch(t){return void r(t)}o.done?e(l):Promise.resolve(l).then(i,n)}var d,f,g={props:{module:{type:String,default:"outgoing"},model:{type:String,default:"transfer"},filters:{type:Object,default:function(){}}},data:function(){return{isLoading:!1,isDownloading:!1,shouldReload:!1,gridData:null,gridSearch:null,gridPage:1,gridColumns:null,gridFilters:null}},components:{},mounted:function(){this.gridSearch=this.$store.state[this.module].search||null,this.regulatoryAgent=this.$store.getters.getAgent,this.schema&&(this.setFilters(this.$route.params.focus),this.gridColumns=this.schema.meta.fields)},methods:{fetchGrid:(d=n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.schema&&this.gridFilters){t.next=4;break}return t.abrupt("return",!1);case 4:if(1!=this.isLoading){t.next=6;break}return t.abrupt("return",!1);case 6:return this.isLoading=!0,t.next=9,(new s.a).setFilters(this.gridFilters.filter).params({search:this.gridSearch}).orderBy((this.gridFilters.orderDesc?"-":"")+this.gridFilters.sortBy).limit(this.gridFilters.pageLimit).page(this.gridPage).get();case 9:this.gridData=t.sent,this.isLoading=!1;case 11:case"end":return t.stop()}}),t,this)})),f=function(){var t=this,e=arguments;return new Promise((function(r,i){var n=d.apply(t,e);function s(t){u(n,r,i,s,a,"next",t)}function a(t){u(n,r,i,s,a,"throw",t)}s(void 0)}))},function(){return f.apply(this,arguments)}),searchGrid:o.a.debounce((function(t){this.gridPage=1,this.fetchGrid()}),500),setFilters:function(){var t=this;arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.schema)return!1;this.gridFilters={pageLimit:20,sortBy:Object.keys(this.schema.filters).find((function(e){return"daterange"===t.schema.filters[e].type}))||"rank",orderDesc:!1,filter:Object.assign.apply(Object,[{}].concat(c(Object.keys(this.schema.filters).map((function(t){return l({},t,["all"])}))),[this.filters]))}},renderRowBg:function(t,e){return null},confirmDelete:function(t){var e=this;this.$swal.fire({title:"Are you sure?",text:"This will Cancel the transfer, and rollback any receiving requests and the package assignments.",type:"warning",showCancelButton:!0,confirmButtonText:"Yes, Cancel Transfer"}).then((function(r){r.value&&(e.isLoading=!0,new s.a({id:t}).delete().then((function(t){e.isLoading=!1,e.$store.dispatch(e.module+"/setSchemas",e.model.toLowerCase()),e.$announcer(t),e.fetchGrid()})).catch((function(t){e.isLoading=!1,e.$announcer(t.response)})))}))},downloadExport:function(t){var e=this;this.isDownloading=!0,axios({url:(new s.a).setFilters(this.gridFilters.filter).custom(this.schema.meta.resource+"/export/"+t).getUrl(),method:"GET",responseType:"blob"}).then((function(t){e.isDownloading=!1,e.downloadFile(t)})).catch((function(t){e.isDownloading=!1,e.$announcer(t.response)}))}},computed:{schema:function(){return this.$store.state[this.module][this.model.toLowerCase()+"Schema"]},columnsVisible:function(){return this.gridColumns?this.gridColumns.filter((function(t){return!0===t.toggle||!t.hasOwnProperty("toggle")})):[]}},watch:{gridFilters:{handler:function(t,e){this.gridPage=1,this.gridFilters&&this.fetchGrid()},deep:!0},gridPage:function(t,e){this.gridFilters&&this.fetchGrid()},schema:{handler:function(t,e){!e&&t?this.setFilters():o.a.isEqual(t.filters,e.filters)?1==this.shouldReload&&(this.fetchGrid(),this.shouldReload=!1):this.setFilters(),t&&!this.gridColumns&&(this.gridColumns=t.meta.fields)},deep:!0}}},h=r("KHd+"),m=Object(h.a)(g,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.schema?r("div",{staticClass:"col-12"},[r("form",[r("div",{staticClass:"table-filter-row"},[r("div",{staticClass:"filter-search",class:{active:t.gridSearch}},[r("div",{staticClass:"input-group"},[t._m(0),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.gridSearch,expression:"gridSearch"}],staticClass:"form-control border-left-0",attrs:{type:"text",placeholder:t.schema.lang.searchPrompt||"Search Grid"},domProps:{value:t.gridSearch},on:{input:[function(e){e.target.composing||(t.gridSearch=e.target.value)},t.searchGrid],keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.searchGrid(e))}}})])]),t._v(" "),t.gridFilters?r("div",{staticClass:"filters"},[t.gridData?r("filter-more",{attrs:{meta:t.gridData.meta,schema:t.schema,gridFilters:t.gridFilters,columns:t.gridColumns,isDownloading:t.isDownloading},on:{"update:gridFilters":function(e){t.gridFilters=e},"update:grid-filters":function(e){t.gridFilters=e},"update:columns":function(e){t.gridColumns=e},downloadExport:t.downloadExport}}):t._e(),t._v(" "),t._l(t.schema.filters,(function(e,i){return"wherein"==e.type?r("filter-in",{key:i,attrs:{schema:e,filter:t.gridFilters.filter[i]},on:{update:function(e){t.gridFilters.filter[i]=e}}}):t._e()})),t._v(" "),t._l(t.schema.filters,(function(e,i){return"daterange"==e.type?r("filter-date",{key:i,attrs:{schema:e,filter:t.gridFilters.filter[i]},on:{update:function(e){t.gridFilters.filter[i]=e}}}):t._e()}))],2):t._e()])]),t._v(" "),r("loading",{attrs:{display:t.isLoading,type:"loadGrid"}}),t._v(" "),r("transition",{attrs:{name:"bo-slide"}},[t.schema&&t.gridFilters?r("b-table",{attrs:{striped:"",hover:"",id:t.model.toLowerCase()+"_table","primary-key":"id",items:t.gridData?t.gridData.data:[],fields:t.columnsVisible,busy:t.isLoading,"show-empty":!0,"sort-by":t.gridFilters.sortBy,"sort-desc":t.gridFilters.orderDesc,"no-local-sorting":!0,"no-local-filtering":!0,"per-page":0,tbodyTrClass:t.renderRowBg,responsive:"md",stacked:"sm"},on:{"update:busy":function(e){t.isLoading=e},"update:sortBy":function(e){return t.$set(t.gridFilters,"sortBy",e)},"update:sort-by":function(e){return t.$set(t.gridFilters,"sortBy",e)},"update:sortDesc":function(e){return t.$set(t.gridFilters,"orderDesc",e)},"update:sort-desc":function(e){return t.$set(t.gridFilters,"orderDesc",e)}},scopedSlots:t._u([t._l(t.schema.meta.fields,(function(e,i){return{key:"head(field.key)",fn:function(i){return[r("em",[e.icon?r("i",{class:e.icon}):t._e(),t._v(" "),e.description?r("i",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:e.description,expression:"field.description",modifiers:{hover:!0}}],staticClass:"hotbox-icon hotbox-icon-c-question",attrs:{title:e.name}}):t._e(),t._v(" "),r("span",[t._v(t._s(i.label))])])]}}})),{key:"cell(created_at)",fn:function(e){return[t._v("\n                "+t._s(t._f("localDate")(e.value))+"\n            ")]}},{key:"cell(updated_at)",fn:function(e){return[t._v("\n                "+t._s(t._f("localDate")(e.value))+"\n            ")]}},{key:"cell(received_at)",fn:function(e){return[t._v("\n                "+t._s(t._f("localDate")(e.value))+"\n            ")]}},{key:"cell(manifest_number)",fn:function(e){return[t._v("\n                "+t._s(e.value)+"\n            ")]}},{key:"cell(receiver)",fn:function(e){return[e.item.receiver?r("span",[t._v("\n                    "+t._s(e.item.receiver.name)+" "+t._s(e.item.receiver.licensenum)),r("br"),t._v(" "),r("span",{staticClass:"small"},[t._v(t._s(e.item.receiver.city))])]):r("span",[t._v("--")])]}},{key:"cell(transporter_name)",fn:function(e){return[e.item.transporter_name?r("span",[t._v("\n                    "+t._s(e.value)),r("br"),t._v(" "),r("span",{staticClass:"small"},[t._v("Lic: "+t._s(e.item.transporter_licensenum))])]):r("span",[t._v("--")])]}},{key:"cell(packages_count)",fn:function(e){return[t._v("\n                "+t._s(e.item.packages.length||0)+"\n            ")]}},{key:"cell(actions)",fn:function(e){return[e.item.received_at?t._e():r("i",{staticClass:"hotbox-icon hotbox-icon-trash-round float-right mr-2 mt-1",on:{click:function(r){return t.confirmDelete(e.item.id)}}}),t._v(" "),r("i",{staticClass:"float-right mr-2 mt-1",class:{"ti-angle-double-down":!e.detailsShowing,"ti-angle-double-up":e.detailsShowing},on:{click:e.toggleDetails}})]}},{key:"row-details",fn:function(e){return[r("div",{staticClass:"card card-stats px-3 justify-content-center"},[r("div",{staticClass:"card-header"}),t._v(" "),r("div",{staticClass:"card-body"},[r("h5",{staticClass:"mt-2"},[t._v("Packages Manifest")]),t._v(" "),r("ul",t._l(e.item.packages,(function(e,i){return r("li",{staticClass:"d-flex justify-content-between align-items-center position-relative px-2 mb-3"},[r("div",{},[t._v("\n                                    "+t._s((e.item||{}).name||"Misc Item")),r("br"),t._v(" "),r("span",{staticClass:"small"},[r("i",{staticClass:"hotbox-icon hotbox-icon-tag-content"}),t._v(" "+t._s(e.label))])]),t._v(" "),r("div",{staticClass:"ml-auto text-right"},[t._v("\n                                    "+t._s(e.quantity)+"/"+t._s(e.unit_of_measure)+"\n                                ")])])})),0)])])]}},t.gridData?{key:"table-caption",fn:function(){return[t.gridData.data.length>0?r("div",[t.gridData.meta?r("span",[t._v("\n                        Showing "+t._s(t.gridData.meta.per_page*(t.gridPage-1)+1)+" to "+t._s(t.gridData.meta.per_page*t.gridPage<t.gridData.meta.total?t.gridData.meta.per_page*t.gridPage:t.gridData.meta.total)+" of "+t._s(t.gridData.meta.total)+" "+t._s(t.schema.lang.items?t.schema.lang.items:"Records")+"\n                    ")]):r("span",[t._v("Showing All "+t._s(t.schema.lang.items?t.schema.lang.items:"Records"))]),t._v(" "),r("div",{staticClass:"table-pager-footer"},[t.gridData.meta.total>0?r("b-pagination",{attrs:{"total-rows":t.gridData.meta.total,"per-page":t.gridData.meta.per_page,"aria-controls":"users_table"},model:{value:t.gridPage,callback:function(e){t.gridPage=e},expression:"gridPage"}}):t._e()],1)]):t._e()]},proxy:!0}:null,{key:"empty",fn:function(){return[t.isLoading?r("div",{staticClass:"h-100"},[t._v("Â ")]):r("div",[r("img",{attrs:{src:"/images/logo.png",alt:"No Results",width:"75"}}),t._v(" "),r("h4",[t._v("Hmm, There are currently no Results.")])])]},proxy:!0}],null,!0)}):t._e()],1)],1):r("div",[r("loading",{attrs:{display:!t.schema,type:"loadPage"}})],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-prepend"},[e("i",{staticClass:"hotbox-icon hotbox-icon-search-2"})])}],!1,null,null,null);e.default=m.exports}}]);